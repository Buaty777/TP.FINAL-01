<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tienda</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background: linear-gradient(to bottom, #000, #fff);
        }
        #fondo {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background-image: url('tienda.png');
            background-size: cover;
            opacity: 0;
            transition: opacity 2s ease-in-out;
        }
        #texto-inicial {
            font-size: 2em;
            color: white;
            text-align: center;
            background-color: rgba(0, 0, 0, 0.5);
            padding: 20px;
            border-radius: 10px;
            display: none;
        }
        #panel-sonido {
            position: fixed;
            bottom: 20px;
            left: 20px;
        }
        button {
            background: transparent;
            border: none;
            color: white;
            font-size: 1.5em;
            margin: 5px;
            cursor: pointer;
        }
        .volume-control {
            margin: 5px;
        }
        img {
            max-width: 100%;
            height: auto;
        }
        #conversacion {
            position: fixed;
            bottom: 100px;
            left: 20px;
            color: white;
            font-size: 1.5em;
        }
    </style>
</head>
<body>
    <div id="fondo"></div>
    <div id="texto-inicial">Cargando...</div>
    <div id="conversacion"></div>
    <div id="panel-sonido">
        <button id="pass-button">Pass</button>
        <input type="range" class="volume-control" id="volume-control" min="0" max="1" step="0.01" value="0.5">
        <label for="volume-control">Volumen</label>
    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.39/Tone.js"></script>
    <script>
        const fondo = document.getElementById('fondo');
        const textoInicial = document.getElementById('texto-inicial');
        const conversacionDiv = document.getElementById('conversacion');
        const passButton = document.getElementById('pass-button');
        const volumeControl = document.getElementById('volume-control');
        let audioVolume = 0.5;

        fondo.style.opacity = 1;

        function mostrarTextoInicial() {
            textoInicial.style.display = 'block';
            setTimeout(() => {
                textoInicial.textContent = 'dos horas y diez minutos después';
                textoInicial.style.display = 'block';
                setTimeout(() => {
                    textoInicial.style.display = 'none';
                }, 3000);
            }, 3000);
        }

        const synth = new Tone.Synth().toDestination();
        const piano = new Tone.Sampler({
            urls: {
                "A0": "A0.mp3",
                "C1": "C1.mp3",
                "D#1": "Ds1.mp3",
                "F#1": "Fs1.mp3",
                "A1": "A1.mp3",
            },
            baseUrl: "https://tonejs.github.io/audio/salamander/"
        }).toDestination();

        const melody = new Tone.Sequence(
            (time, note) => {
                piano.triggerAttackRelease(note, "10n", time);
            },
            ["C4", "E4", "G4", "A4", null, "A4", "G4", "E4", "C4", "A3", "E3", "C3", "G3", null, "E3", "G3", "A3", "C4"],
            "4n"
        );

        Tone.start();
        Tone.Transport.start();
        melody.start();

        volumeControl.addEventListener('input', () => {
            audioVolume = volumeControl.value;
            Tone.getDestination().volume.value = audioVolume * 10; 
        });

        passButton.addEventListener('click', () => {
            if (passButton.disabled) return;
            passButton.disabled = true;

            const dialogo = [
                "[nombre del usuario]: una...una tienda?!",
                "[nombre del usuario]: no me digas que debo encargarme de esto la #### madre...",
                "Abogado: muchacho!",
                "[nombre del usuario] (pensamiento): es...un maniquí?",
                "[nombre del usuario]: h-hola",
                "Abogado: bueno, como ya viste, el viejo corps te dejó una tienda. No preguntes el porqué ni el cómo",
                "[nombre del usuario]: pero...",
                "Abogado: dije no preguntes!, ahora sígueme.",
                "[nombre del usuario]: bueno..."
            ];

            let index = 0;

            function mostrarDialogo() {
                if (index < dialogo.length) {
                    conversacionDiv.textContent = dialogo[index];
                    index++;
                    setTimeout(mostrarDialogo, 2000);
                } else {
                    conversacionDiv.textContent = "";
                    passButton.disabled = false;
                }
            }

            mostrarDialogo();
            mostrarTextoInicial();
        });

        mostrarTextoInicial();
    </script>
</body>
</html>

