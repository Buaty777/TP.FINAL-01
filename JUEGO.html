<!DOCTYPE html>
<html lang="es">
<head>
    <link rel="icon" href="LOGO 1.ico" type="image/x-icon">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>K.T.P (EL JUEGO)</title>
    <style>
        body {
            font-family: 'Press Start 2P', cursive;
            background-image: url('tienda.png');
            background-size: cover;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            text-align: center;
            overflow: hidden;
        }

        #abogado, #npc1, #npc2 {
            position: absolute;
            bottom: 20px;
            right: 10%;
            width: 200px;
            display: none;
            transition: transform 0.5s ease, opacity 0.5s ease;
            opacity: 0;
            animation: npcAnimation 1.5s infinite alternate ease-in-out;
        }

        @keyframes npcAnimation {
            0% { transform: translateY(0); }
            100% { transform: translateY(-10px); }
        }

        .panel-dialogo {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.8);
            border-radius: 10px;
            padding: 20px;
            width: 80%;
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.5);
            display: block;
        }

        .texto-dialogo {
            margin: 0;
            font-size: 18px;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .texto-visible {
            opacity: 1;
        }

        .menu-sonido {
            display: none;
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            width: 200px;
            background-color: rgba(34, 85, 34, 0.8);
            border-radius: 10px;
            padding: 10px;
            box-sizing: border-box;
            backdrop-filter: blur(5px);
        }

        .boton {
            background-color: transparent;
            border: 2px solid rgba(255, 255, 255, 0.3);
            cursor: pointer;
            padding: 10px;
            margin: 5px;
            font-size: 16px;
            transition: transform 0.2s, border-color 0.2s;
        }

        .boton img {
            width: 40px;
            height: 40px;
        }

        .boton:hover {
            transform: scale(1.1);
            border-color: rgba(255, 255, 255, 0.6);
        }

        #boton-saltar {
            position: absolute;
            bottom: 10px;
            left: 10px;
            padding: 10px 20px;
        }

        #boton-detener {
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
        }

        #pantalla-negra {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: black;
            display: none;
            z-index: 9999;
        }

        #resultado {
            margin: 10px;
            padding: 5px;
            border: 1px solid white;
            width: 80%;
            text-align: center;
        }
    </style>
</head>
<body>
    <div id="pantalla-negra"></div>
    <img src="abogado.png" alt="Abogado" id="abogado">
    <img src="npc 1.png" alt="NPC 1" id="npc1">
    <img src="npc 2.png" alt="NPC 2" id="npc2">

    <div class="panel-dialogo" id="panel-dialogo">
        <p class="texto-dialogo" id="texto-dialogo"></p>
        <p id="introduccion" class="texto-dialogo"></p>
    </div>

    <div class="menu-sonido" id="menu-sonido">
        <p>Menú de Sonido</p>
        <input type="range" min="0" max="100" value="50" class="barra-volumen" id="control-volumen" oninput="cambiarVolumen(this.value)">
        <input type="range" min="0" max="100" value="50" class="barra-volumen" id="control-volumen-efectos" oninput="cambiarVolumenEfectos(this.value)">
        <div>
            <button class="boton" onclick="irAIndex()">
                <img src="salir.png" alt="Salir">
            </button>
            <button class="boton" id="boton-play" onclick="activarPlay()">
                <img src="inicio.png" alt="Iniciar Música">
            </button>
            <button class="boton" id="boton-pausa" onclick="activarPausa()">
                <img src="pausa.png" alt="Pausar Música">
            </button>
        </div>
    </div>

    <button class="boton" id="boton-saltar" onclick="saltarCinematica()">
        <img src="pass.png" alt="Saltar Cinemática">
    </button>

    <button class="boton" id="boton-detener" onclick="activarMenuSonido()">
        <img src="stop.png" alt="Control de Sonido">
    </button>

    <button class="boton" id="boton-calculadora" onclick="abrirCalculadora()">
        <img src="calculadora.png" alt="Calculadora">
    </button>

    <button class="boton" id="boton-precios" onclick="mostrarPrecios()">
        <img src="nota.png" alt="Lista de Precios">
    </button>

    <div id="resultado"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.39/Tone.js"></script>
    <script>
        let indiceDialogo = 0;
        const dialogos = [
            `Luego de unos instantes, el abogado (Max) te explicó lo básico. En la parte superior izquierda tienes dos botones, uno te abre una lista la cuál tiene los precios de las cosas y el otro una calculadora, arréglate con eso.`,
            `[abogado] Abogado: ¡Dije que no preguntes! Sígueme.`
        ];

        const precios = {
            Jabón: 900,
            Chetos: 1700,
            Refresco: 800,
            Queso: 1200,
            Uranio: 11000
        };

        function mostrarDialogo() {
            if (indiceDialogo < dialogos.length) {
                const dialogoElemento = document.getElementById('texto-dialogo');
                dialogoElemento.classList.add('texto-visible');
                dialogoElemento.textContent = dialogos[indiceDialogo];
                indiceDialogo++;
                mostrarAbogado();
                setTimeout(() => {
                    dialogoElemento.classList.remove('texto-visible');
                    setTimeout(() => {
                        if (indiceDialogo >= dialogos.length) {
                            iniciarNPC1();
                        } else {
                            mostrarDialogo();
                        }
                    }, 500);
                }, 3000);
            }
        }

        function mostrarAbogado() {
            const abogado = document.getElementById('abogado');
            abogado.style.display = 'block';
            abogado.style.opacity = 1;
        }

        function iniciarNPC1() {
            const npc1 = document.getElementById('npc1');
            npc1.style.display = 'block';
            mostrarNPCDialogo(npc1, "Ay Holis!!!! Me dices cuánto sería el jabón y dos refrescos, tres chetos y un queso plis?");
        }

        function mostrarNPCDialogo(npc, mensaje) {
            const dialogoElemento = document.getElementById('texto-dialogo');
            dialogoElemento.classList.add('texto-visible');
            dialogoElemento.textContent = mensaje;
            setTimeout(() => {
                dialogoElemento.classList.remove('texto-visible');
                const resultadoElemento = document.getElementById('resultado');
                const respuesta = prompt("Por favor, introduce el precio total:");
                evaluarRespuesta(respuesta, 900 + (2 * 800) + (3 * 1700) + 1200, npc);
            }, 3000);
        }

        function evaluarRespuesta(respuesta, correcto, npc) {
            if (parseInt(respuesta) === correcto) {
                alert("Ayyy muchas gracias!!!");
            } else if (parseInt(respuesta) > correcto) {
                alert("Oye!!! Esto es una estafa...");
            } else {
                alert("Oh!!! Una ganga!!!");
            }
            npc.style.display = 'none';
            iniciarNPC2();
        }

        function iniciarNPC2() {
            const npc2 = document.getElementById('npc2');
            npc2.style.display = 'block';
            mostrarNPCDialogo(npc2, "Dame siete quesos...");
        }

        function mostrarPrecios() {
            let listaPrecios = "Lista de Precios:\n";
            for (const producto in precios) {
                listaPrecios += `${producto} = ${precios[producto]}\n`;
            }
            alert(listaPrecios);
        }

        function abrirCalculadora() {
            const calculadoraHTML = `
            <div id="calculadora" style="background-color: white; padding: 20px; border-radius: 10px; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);">
                <h2>Calculadora</h2>
                <input type="text" id="display" readonly style="width: 100%; margin-bottom: 10px;">
                <div>
                    ${[1, 2, 3, 4, 5].map(num => `<button onclick="agregarNumero(${num})">${num}</button>`).join('')}
                </div>
                <div>
                    <button onclick="agregarOperacion('+')">+</button>
                    <button onclick="agregarOperacion('-')">-</button>
                    <button onclick="calcular()">=</button>
                    <button onclick="cerrarCalculadora()">Cerrar</button>
                </div>
            </div>`;
            document.body.insertAdjacentHTML('beforeend', calculadoraHTML);
        }

        function agregarNumero(num) {
            const display = document.getElementById('display');
            display.value += num;
        }

        function agregarOperacion(operacion) {
            const display = document.getElementById('display');
            display.value += ` ${operacion} `;
        }

        function calcular() {
            const display = document.getElementById('display');
            const resultado = eval(display.value);
            alert(`Resultado: ${resultado}`);
            display.value = '';
        }

        function cerrarCalculadora() {
            const calculadora = document.getElementById('calculadora');
            if (calculadora) {
                calculadora.remove();
            }
        }

        function iniciarCancion() {
            const synth = new Tone.Synth().toDestination();
            const loop = new Tone.Loop((time) => {
                synth.triggerAttackRelease("C4", "8n", time);
                synth.triggerAttackRelease("E4", "8n", time + 0.5);
                synth.triggerAttackRelease("G4", "8n", time + 1);
            }, "2n").start(0);
            Tone.Transport.bpm.value = 90;
            Tone.Transport.start();
        }

        window.onload = function() {
            document.getElementById('pantalla-negra').style.display = 'block';
            setTimeout(() => {
                document.getElementById('pantalla-negra').style.display = 'none';
                mostrarDialogo();
                iniciarCancion();
            }, 4000);
        };

        function cambiarVolumen(volumen) {
        }

        function cambiarVolumenEfectos(volumen) {
        }

        function activarMenuSonido() {
            const menuSonido = document.getElementById('menu-sonido');
            menuSonido.style.display = menuSonido.style.display === 'block' ? 'none' : 'block';
        }

        function activarPlay() {
        }

        function activarPausa() {
        }

        function irAIndex() {
            window.location.href = 'index.html';
        }
    </script>
</body>
</html>
