<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>K.T.P (EL JUEGO)</title>
    <style>
        body {
            font-family: 'Press Start 2P', cursive;
            background-image: url('tienda.jpg');
            background-size: cover;
            color: white;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            text-align: center;
            overflow: hidden;
        }

        #npc {
            position: absolute;
            bottom: 20px;
            left: 50px;
            width: 300px;
            display: block;
            animation: npcAnimation 1.5s infinite alternate ease-in-out;
        }

        @keyframes npcAnimation {
            0% { transform: translateY(0); }
            100% { transform: translateY(-10px); }
        }

        .panel-dialogo {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.8);
            border-radius: 10px;
            padding: 20px;
            width: 80%;
            display: block;
        }

        .texto-dialogo {
            margin: 0;
            font-size: 18px;
            opacity: 1;
        }

        .menu-sonido {
            display: block;
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            width: 200px;
            background-color: rgba(34, 85, 34, 0.8);
            border-radius: 10px;
            padding: 10px;
            box-sizing: border-box;
            backdrop-filter: blur(5px);
        }

        .boton {
            background-color: transparent;
            border: 2px solid rgba(255, 255, 255, 0.3);
            cursor: pointer;
            padding: 10px;
            margin: 5px;
            font-size: 16px;
            transition: transform 0.2s, border-color 0.2s;
        }

        .boton img {
            width: 40px;
            height: 40px;
        }

        .boton:hover {
            transform: scale(1.1);
            border-color: rgba(255, 255, 255, 0.6);
        }

        #calculadora {
            position: absolute;
            top: 50px;
            left: 20px;
            width: 120px;
            background-color: rgba(0, 0, 0, 0.8);
            padding: 10px;
            border-radius: 10px;
            display: none;
            font-size: 10px;
            border: 4px solid white;
        }

        #calculadora input {
            width: 100%;
            padding: 5px;
            margin-bottom: 5px;
            font-size: 12px;
            text-align: right;
            background-color: rgba(255, 255, 255, 0.8);
            border: 3px solid white;
            color: black;
        }

        #resultado {
            width: 100%;
            padding: 5px;
            font-size: 12px;
            text-align: right;
            color: black;
            background-color: rgba(255, 255, 255, 0.8);
            border: 3px solid white;
        }

        #lista-precios {
            position: absolute;
            top: 80px;
            left: 20px;
            width: 150px;
            background-color: rgba(0, 0, 0, 0.8);
            padding: 10px;
            border-radius: 10px;
            display: none;
            font-size: 12px;
            color: white;
            font-family: 'Courier New', Courier, monospace;
            border: 4px solid white;
        }

        #menu-superior {
            position: absolute;
            top: 10px;
            right: 10px;
            display: flex;
            flex-direction: row;
            align-items: center;
        }

        #boton-salir img {
            width: 30px;
            height: 30px;
        }
    </style>
</head>
<body>
    <div id="pantalla-negra">
        <h1>Cargando...</h1>
    </div>

    <div class="panel-dialogo" id="panel-dialogo">
        <p class="texto-dialogo" id="texto-dialogo">Luego de unos instantes, el abogado (Max) te explicó lo básico, en la parte superior izquierda tienes dos botones, uno te abre una lista la cual tiene los precios de las cosas y el otro una calculadora, arréglate con eso.</p>
        <button id="boton-pasar" class="boton" onclick="pasarDialogo()">Pasar</button>
    </div>

    <div class="menu-sonido" id="menu-sonido">
        <p>Menú de Sonido</p>
        <input type="range" min="0" max="100" value="50" id="control-volumen" oninput="cambiarVolumen(this.value)">
        <button id="boton-sonido" class="boton" onclick="togglePanelSonido()">
            <img src="stop.png" alt="Abrir/Cerrar Sonido">
        </button>
    </div>

    <div id="calculadora">
        <input type="text" id="resultado" disabled>
        <div>
            <button onclick="agregarNumero(1)">1</button>
            <button onclick="agregarNumero(2)">2</button>
            <button onclick="agregarNumero(3)">3</button>
        </div>
        <div>
            <button onclick="agregarNumero(4)">4</button>
            <button onclick="agregarNumero(5)">5</button>
            <button onclick="sumar()">+</button>
        </div>
        <div>
            <button onclick="restar()">-</button>
            <button onclick="calcular()">=</button>
            <button onclick="borrar()">C</button>
        </div>
    </div>

    <div id="lista-precios">
        <p><strong>Precios</strong></p>
        <p>Jabón: 900</p>
        <p>Chetos: 1700</p>
        <p>Refresco: 800</p>
        <p>Queso: 1200</p>
        <p>Uranio: 11000</p>
    </div>

    <div id="menu-superior">
        <button id="boton-calculadora" class="boton" onclick="toggleCalculadora()">
            <img src="calculadora.png" alt="Calculadora">
        </button>
        <button id="boton-precios" class="boton" onclick="togglePrecios()">
            <img src="nota.png" alt="Precios">
        </button>
        <button id="boton-salir" onclick="window.location.href='index.html'">
            <img src="salir.png" alt="Salir">
        </button>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.39/Tone.js"></script>
    <script>
        const synth = new Tone.Synth().toDestination();
        const melody = new Tone.Sequence(
            (time, note) => {
                synth.triggerAttackRelease(note, '8n', time);
            },
            ['C4', 'E4', 'G4', 'B4', 'C5'],
            '4n'
        );

        Tone.Transport.start();
        melody.start();

        function cambiarVolumen(volumen) {
            Tone.Transport.volume.value = volumen - 100;
        }

        function togglePanelSonido() {
            const menuSonido = document.getElementById('menu-sonido');
            menuSonido.style.display = (menuSonido.style.display === 'block') ? 'none' : 'block';
        }

        function toggleCalculadora() {
            const calculadora = document.getElementById('calculadora');
            calculadora.style.display = (calculadora.style.display === 'block') ? 'none' : 'block';
        }

        function togglePrecios() {
            const listaPrecios = document.getElementById('lista-precios');
            listaPrecios.style.display = (listaPrecios.style.display === 'block') ? 'none' : 'block';
        }

        function agregarNumero(numero) {
            const resultadoInput = document.getElementById('resultado');
            resultadoInput.value += numero;
        }

        function sumar() {
            operacion = '+';
            const resultadoInput = document.getElementById('resultado');
            resultado = parseInt(resultadoInput.value);
            resultadoInput.value = '';
        }

        function restar() {
            operacion = '-';
            const resultadoInput = document.getElementById('resultado');
            resultado = parseInt(resultadoInput.value);
            resultadoInput.value = '';
        }

        function calcular() {
            const resultadoInput = document.getElementById('resultado');
            let total;
            if (operacion === '+') {
                total = resultado + parseInt(resultadoInput.value);
            } else if (operacion === '-') {
                total = resultado - parseInt(resultadoInput.value);
            }
            resultadoInput.value = total;
            evaluarResultado(total);
        }

        function borrar() {
            document.getElementById('resultado').value = '';
        }

        function evaluarResultado(total) {
            const textoDialogo = document.getElementById('texto-dialogo');
            const npc = document.getElementById('npc');

            if (total === 4900) {
                textoDialogo.innerText = "Ayyy muchas gracias!!!";
                npc.src = "npc1.png";
                npc.style.display = 'block';
            } else if (total > 4900) {
                textoDialogo.innerText = "Oye!!! Esto es una estafa...";
                npc.src = "npc1.png";
                npc.style.display = 'block';
            } else {
                textoDialogo.innerText = "Oh!!! Una ganga!!!";
                npc.src = "npc1.png";
                npc.style.display = 'block';
            }
        }

        let dialogoActual = 0;
        const dialogos = [
            "Luego de unos instantes, el abogado (Max) te explicó lo básico, en la parte superior izquierda tienes dos botones, uno te abre una lista la cual tiene los precios de las cosas y el otro una calculadora, arréglate con eso.",
            "Ayyy muchas gracias!!!",
            "Oye!!! Esto es una estafa...",
            "Oh!!! Una ganga!!!"
        ];

        function pasarDialogo() {
            if (dialogoActual < dialogos.length - 1) {
                dialogoActual++;
                document.getElementById('texto-dialogo').innerText = dialogos[dialogoActual];
                if (dialogoActual === 1) {
                    document.getElementById('npc').src = "npc1.png";
                    document.getElementById('npc').style.display = 'block';
                }
            }
        }
    </script>
</body>
</html>
