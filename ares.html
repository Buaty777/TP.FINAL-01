<!DOCTYPE html>
<html lang="es">
<head>
    <link rel="icon" href="LOGO 1.ico" type="image/x-icon">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>K.T.P (THE GAME)</title>
    <style>
        body {
            font-family: 'Press Start 2P', cursive;
            background-image: url('paisaje_1.png');
            background-size: cover; /* Asegura que la imagen cubra todo el fondo */
            background-position: center; /* Centra la imagen */
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            text-align: center;
            overflow: hidden;
            position: relative; /* Posiciona el contenedor */
        }

        /* Ocultar todo el contenido del juego */
        #game-intro,
        .dialogue-panel,
        .menu,
        #skip-button,
        #stop-button {
            display: none; /* Ocultar todos los elementos */
        }
    </style>
</head>
<body>

    <div id="game-intro" class="hidden">
        <p>Un día, yo <span id="player-name" class="player-text"></span> recibí una llamada de un abogado,</p>
        <p class="lawyer-text">su voz era seria y ronca, solo atinó a decir:</p>
        <p class="lawyer-text">"Muchacho, el Sr. CROPS me encargó que te diera unas cosas... ven a la ciudad Pit para aclarar todo..."</p>
        <p>Y así empezó mi historia...</p>
    </div>

    <div class="dialogue-panel" id="dialogue-panel">
        <p class="dialogue-text" id="dialogue-text"></p>
    </div>

    <div class="menu" id="sound-menu">
        <p>Menú</p>
        <input type="range" min="0" max="100" value="30" class="volume-slider" id="volume-slider" oninput="changeVolume(this.value)">
        <input type="range" min="0" max="100" value="30" class="volume-slider" id="effect-volume-slider" oninput="changeEffectVolume(this.value)">
        <div>
            <button class="button" onclick="goToIndex()">
                <img src="salir.png" alt="Salir">
            </button>
            <button class="button" id="play-button" onclick="togglePlay()">
                <img src="inicio.png" alt="Iniciar Música">
            </button>
            <button class="button" id="pause-button" onclick="togglePause()">
                <img src="pausa.png" alt="Pausar Música">
            </button>
        </div>
    </div>

    <button class="button" id="skip-button" onclick="skipCutscene()">
        <img src="pass.png" alt="Saltar Cinemática">
    </button>

    <button class="button" id="stop-button" onclick="toggleSoundMenu()">
        <img src="stop.png" alt="Control de Sonido">
    </button>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.39/Tone.js"></script>
    <script>
        const playerName = prompt("Introduce tu nombre:");
        document.getElementById('player-name').textContent = playerName;

        let isPlaying = false;
        let dialogueIndex = 0;
        const dialogueLines = [
            `${playerName} ... *Sonido de teléfono*`,
            `${playerName} *contesta*`,
            `Abogado: Hola muchacho, ¿cómo va el viaje?`,
            `${playerName}: Bueno... va bien, va bien... solo que me sigo pensando por qué debo ir yo...`,
            `Abogado: No lo sé... el viejo Corps estaba algo loco jajaja`,
            `${playerName}: ...`,
            `Abogado: En fin, te espero donde te dije que estaría, adiós.`,
            `*La llamada termina*`,
            `${playerName}: ..., en verdad esto será raro...`
        ];

        function showIntro() {
            const introElement = document.getElementById('game-intro');
            introElement.classList.remove('hidden');
            introElement.style.display = 'block';

            setTimeout(() => {
                introElement.style.opacity = 1;
            }, 100);
        }

        function skipCutscene() {
            document.getElementById('game-intro').style.display = 'none';
            document.getElementById('dialogue-panel').style.display = 'block';
            displayDialogue();
        }

        function toggleSoundMenu() {
            const menu = document.getElementById('sound-menu');
            menu.style.display = (menu.style.display === 'block') ? 'none' : 'block';
        }

        function goToIndex() {
            window.location.href = 'index.html';
        }

        function togglePlay() {
            if (!isPlaying) {
                Tone.Transport.start();
                isPlaying = true;
            }
        }

        function togglePause() {
            if (isPlaying) {
                Tone.Transport.pause();
                isPlaying = false;
            }
        }

        const volumeSlider = document.getElementById('volume-slider');
        volumeSlider.addEventListener('input', (event) => {
            const volume = event.target.value;
            Tone.Destination.volume.value = (volume - 100) / 100;
        });

        const effectVolumeSlider = document.getElementById('effect-volume-slider');
        effectVolumeSlider.addEventListener('input', (event) => {
            const effectVolume = event.target.value;
        });

        function changeVolume(value) {
            Tone.Destination.volume.value = (value - 100) / 100;
        }

        function changeEffectVolume(value) {
        }

        function displayDialogue() {
            if (dialogueIndex < dialogueLines.length) {
                const line = dialogueLines[dialogueIndex];
                const dialogueText = document.getElementById('dialogue-text');
                dialogueText.textContent = '';
                let charIndex = 0;

                const typingInterval = setInterval(() => {
                    if (charIndex < line.length) {
                        dialogueText.textContent += line.charAt(charIndex);
                        charIndex++;
                        const typingSound = new Tone.Synth().toDestination();
                        typingSound.triggerAttackRelease('C4', '8n');
                    } else {
                        clearInterval(typingInterval);
                        dialogueIndex++;
                        setTimeout(displayDialogue, 1000);
                    }
                }, 200);
            }
        }

        const buttons = document.querySelectorAll('.button');
        buttons.forEach(button => {
            button.addEventListener('click', () => {
                const clickSound = new Tone.Synth().toDestination();
                clickSound.triggerAttackRelease('C4', '8n');
            });
        });

        window.onload = function() {
            showIntro();
        };
    </script>
</body>
</html>
